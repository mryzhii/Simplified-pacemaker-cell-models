<?xml version='1.0' encoding='UTF-8'?>
<!--
 This CellML file was generated by M. Ryzhii, University of Aizu
 07/12/2021

 openCOR  https://opencor.ws/
 CellML 1.0 was used to generate this cellular model
 http://www.CellML.org/

Pacemaking variant of the Corrado & Niederer two-variable cell model. 
M. Ryzhii, University of Aizu, Japan
E. Ryzhii, Fukushima Medical University, Japan
(2022) "Pacemaking function of two simplified cell models"
PLoS ONE 17(4): e0257935. doi.org/10.1371/journal.pone.0257935 
-->
<!--  Set stim_start to a value less than stim_end to observe 
  the effect of external current-->
<model name="oscillating_aliev_panfilov_1996" xmlns="http://www.cellml.org/cellml/1.0#" xmlns:cellml="http://www.cellml.org/cellml/1.0#">
    <units name="millisecond">
        <unit prefix="milli" units="second"/>
    </units>
    <units name="per_millisecond">
        <unit exponent="-1" prefix="milli" units="second"/>
    </units>
    <component name="Main">
        <variable name="t" units="millisecond"/>
        <variable initial_value="0.01" name="u" units="dimensionless"/>
        <variable initial_value="0.01" name="v" units="dimensionless"/>
        <variable initial_value="0.0775" name="ct" units="dimensionless"/>
        <variable initial_value="0.01" name="b" units="dimensionless"/>
        <variable initial_value="0.13" name="a" units="dimensionless"/>
        <variable initial_value="0.002" name="eps0" units="dimensionless"/>
        <variable initial_value="3000" name="Istim_start" units="millisecond"/>
        <variable initial_value="5000" name="Istim_end" units="millisecond"/>
        <variable initial_value="0.002" name="Istim_amplitude" units="dimensionless"/>
        <variable name="I" units="dimensionless"/>
        <variable initial_value="8" name="k" units="dimensionless"/>
        <variable initial_value="0.2" name="mu1" units="dimensionless"/>
        <variable initial_value="0.3" name="mu2" units="dimensionless"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>I</ci>
                <piecewise>
                    <piece>
                        <ci>Istim_amplitude</ci>
                        <apply>
                            <and/>
                            <apply>
                                <lt/>
                                <ci>Istim_start</ci>
                                <ci>Istim_end</ci>
                            </apply>
                            <apply>
                                <geq/>
                                <ci>t</ci>
                                <ci>Istim_start</ci>
                            </apply>
                            <apply>
                                <leq/>
                                <ci>t</ci>
                                <ci>Istim_end</ci>
                            </apply>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="dimensionless">0</cn>
                    </otherwise>
                </piecewise>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>u</ci>
                </apply>
                <apply>
                    <plus/>
                    <apply>
                        <times/>
                        <ci>ct</ci>
                        <apply>
                            <minus/>
                            <apply>
                                <times/>
                                <ci>k</ci>
                                <ci>u</ci>
                                <apply>
                                    <plus/>
                                    <ci>u</ci>
                                    <ci>b</ci>
                                </apply>
                                <apply>
                                    <minus/>
                                    <cn cellml:units="dimensionless">1</cn>
                                    <ci>u</ci>
                                </apply>
                            </apply>
                            <apply>
                                <times/>
                                <ci>u</ci>
                                <ci>v</ci>
                            </apply>
                        </apply>
                    </apply>
                    <ci>I</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>v</ci>
                </apply>
                <apply>
                    <times/>
                    <ci>ct</ci>
                    <apply>
                        <plus/>
                        <ci>eps0</ci>
                        <apply>
                            <divide/>
                            <apply>
                                <times/>
                                <ci>v</ci>
                                <ci>mu1</ci>
                            </apply>
                            <apply>
                                <plus/>
                                <ci>u</ci>
                                <ci>mu2</ci>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <minus/>
                        <apply>
                            <minus/>
                            <ci>v</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>k</ci>
                            <ci>u</ci>
                            <apply>
                                <minus/>
                                <apply>
                                    <minus/>
                                    <ci>u</ci>
                                    <ci>a</ci>
                                </apply>
                                <cn cellml:units="dimensionless">1</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
        </math>
    </component>
</model>
