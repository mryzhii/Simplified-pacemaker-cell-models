<?xml version='1.0' encoding='UTF-8'?>
<!--
 This CellML file was generated by M. Ryzhii, University of Aizu
 07/12/2021

 openCOR  https://opencor.ws/
 CellML 1.0 was used to generate this cellular model
 http://www.CellML.org/

 Modified pacemaking Corrado & Niederer two-variable cell model. 
 Ryzhii M, Ryzhii E. Pacemaking function of two simplified cell models (2021).
 under review
 https://-->
<model name="corrado_oscillator_2021" xmlns="http://www.cellml.org/cellml/1.0#" xmlns:cellml="http://www.cellml.org/cellml/1.0#">
    <units name="ms">
        <unit prefix="milli" units="second"/>
    </units>
    <units name="per_ms">
        <unit exponent="-1" prefix="milli" units="second"/>
    </units>
    <component name="environment">
        <variable name="time" public_interface="out" units="ms"/>
    </component>
    <component name="J_stim">
        <variable name="J_stim" public_interface="out" units="per_ms"/>
        <variable initial_value="0" name="IstimStart" units="ms"/>
        <variable initial_value="50000" name="IstimEnd" units="ms"/>
        <variable initial_value="0.0" name="IstimAmplitude" units="per_ms"/>
        <variable initial_value="500" name="IstimPeriod" units="ms"/>
        <variable initial_value="1" name="IstimPulseDuration" units="ms"/>
        <variable name="time" public_interface="in" units="ms"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>J_stim</ci>
                <piecewise>
                    <piece>
                        <ci>IstimAmplitude</ci>
                        <apply>
                            <and/>
                            <apply>
                                <geq/>
                                <ci>time</ci>
                                <ci>IstimStart</ci>
                            </apply>
                            <apply>
                                <leq/>
                                <ci>time</ci>
                                <ci>IstimEnd</ci>
                            </apply>
                            <apply>
                                <leq/>
                                <apply>
                                    <minus/>
                                    <apply>
                                        <minus/>
                                        <ci>time</ci>
                                        <ci>IstimStart</ci>
                                    </apply>
                                    <apply>
                                        <times/>
                                        <apply>
                                            <floor/>
                                            <apply>
                                                <divide/>
                                                <apply>
                                                    <minus/>
                                                    <ci>time</ci>
                                                    <ci>IstimStart</ci>
                                                </apply>
                                                <ci>IstimPeriod</ci>
                                            </apply>
                                        </apply>
                                        <ci>IstimPeriod</ci>
                                    </apply>
                                </apply>
                                <ci>IstimPulseDuration</ci>
                            </apply>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="per_ms">0</cn>
                    </otherwise>
                </piecewise>
            </apply>
        </math>
    </component>
    <component name="membrane">
        <variable initial_value="0.01" name="Vm" public_interface="out" units="dimensionless"/>
        <variable name="time" public_interface="in" units="ms"/>
        <variable name="J_in" public_interface="in" units="per_ms"/>
        <variable name="J_out" public_interface="in" units="per_ms"/>
        <variable name="J_stim" public_interface="in" units="per_ms"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>Vm</ci>
                </apply>
                <apply>
                    <plus/>
                    <ci>J_in</ci>
                    <ci>J_out</ci>
                    <ci>J_stim</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="J_in">
        <variable name="J_in" public_interface="out" units="per_ms"/>
        <variable initial_value="0.3" name="tau_in" units="ms"/>
        <variable name="time" private_interface="out" public_interface="in" units="ms"/>
        <variable initial_value="-0.05" name="V_gate" public_interface="out" units="dimensionless"/>
        <variable name="Vm" private_interface="out" public_interface="in" units="dimensionless"/>
        <variable initial_value="0.9" name="h" public_interface="out" units="dimensionless"/>
        <variable initial_value="0.20" name="b" units="dimensionless"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>J_in</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>h</ci>
                        <ci>Vm</ci>
                        <apply>
                            <plus/>
                            <ci>Vm</ci>
                            <ci>b</ci>
                        </apply>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <ci>Vm</ci>
                        </apply>
                    </apply>
                    <ci>tau_in</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="J_in_h_gate">
        <variable name="h" public_interface="in" units="dimensionless"/>
        <variable initial_value="120" name="tau_open" units="ms"/>
        <variable initial_value="150" name="tau_close" units="ms"/>
        <variable name="V_gate" public_interface="in" units="dimensionless"/>
        <variable name="Vm" public_interface="in" units="dimensionless"/>
        <variable name="tau" units="ms"/>
        <variable name="h_inf" units="dimensionless"/>
        <variable name="time" public_interface="in" units="ms"/>
        <variable initial_value="0.15" name="V_s" units="dimensionless"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>tau</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>tau_open</ci>
                        <ci>tau_close</ci>
                    </apply>
                    <apply>
                        <minus/>
                        <ci>tau_open</ci>
                        <apply>
                            <times/>
                            <ci>h_inf</ci>
                            <apply>
                                <minus/>
                                <ci>tau_close</ci>
                                <ci>tau_open</ci>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>h_inf</ci>
                <apply>
                    <times/>
                    <cn cellml:units="dimensionless">0.5</cn>
                    <apply>
                        <minus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <tanh/>
                            <apply>
                                <divide/>
                                <apply>
                                    <minus/>
                                    <ci>Vm</ci>
                                    <ci>V_gate</ci>
                                </apply>
                                <ci>V_s</ci>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>h</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>h_inf</ci>
                        <ci>h</ci>
                    </apply>
                    <ci>tau</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="J_out">
        <variable name="J_out" public_interface="out" units="per_ms"/>
        <variable initial_value="6" name="tau_out" units="ms"/>
        <variable name="Vm" private_interface="out" public_interface="in" units="dimensionless"/>
        <variable name="h" private_interface="in" units="dimensionless"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>J_out</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <apply>
                            <minus/>
                            <apply>
                                <minus/>
                                <cn cellml:units="dimensionless">1</cn>
                                <ci>h</ci>
                            </apply>
                        </apply>
                        <ci>Vm</ci>
                    </apply>
                    <ci>tau_out</ci>
                </apply>
            </apply>
        </math>
    </component>
    <group>
        <relationship_ref relationship="encapsulation"/>
        <component_ref component="J_in">
            <component_ref component="J_in_h_gate"/>
        </component_ref>
    </group>
    <connection>
        <map_components component_1="membrane" component_2="environment"/>
        <map_variables variable_1="time" variable_2="time"/>
    </connection>
    <connection>
        <map_components component_1="J_stim" component_2="environment"/>
        <map_variables variable_1="time" variable_2="time"/>
    </connection>
    <connection>
        <map_components component_1="J_in" component_2="environment"/>
        <map_variables variable_1="time" variable_2="time"/>
    </connection>
    <connection>
        <map_components component_1="membrane" component_2="J_stim"/>
        <map_variables variable_1="J_stim" variable_2="J_stim"/>
    </connection>
    <connection>
        <map_components component_1="membrane" component_2="J_in"/>
        <map_variables variable_1="Vm" variable_2="Vm"/>
        <map_variables variable_1="J_in" variable_2="J_in"/>
    </connection>
    <connection>
        <map_components component_1="membrane" component_2="J_out"/>
        <map_variables variable_1="Vm" variable_2="Vm"/>
        <map_variables variable_1="J_out" variable_2="J_out"/>
    </connection>
    <connection>
        <map_components component_1="J_in" component_2="J_in_h_gate"/>
        <map_variables variable_1="Vm" variable_2="Vm"/>
        <map_variables variable_1="h" variable_2="h"/>
        <map_variables variable_1="time" variable_2="time"/>
        <map_variables variable_1="V_gate" variable_2="V_gate"/>
    </connection>
    <connection>
        <map_components component_1="J_in" component_2="J_out"/>
        <map_variables variable_1="h" variable_2="h"/>
    </connection>
    <documentation xmlns="http://cellml.org/tmp-documentation">
        <article xmlns="http://cellml.org/tmp-documentation">
            <articleinfo xmlns="http://cellml.org/tmp-documentation">
                <title xmlns="http://cellml.org/tmp-documentation">A Simplified Ventricular Myocyte Model</title>
                <author xmlns="http://cellml.org/tmp-documentation">
                    <firstname xmlns="http://cellml.org/tmp-documentation">Catherine</firstname>
                    <surname xmlns="http://cellml.org/tmp-documentation">Lloyd</surname>
                    <affiliation xmlns="http://cellml.org/tmp-documentation">
                        <shortaffil xmlns="http://cellml.org/tmp-documentation">Auckland Bioengineering Institute</shortaffil>
                    </affiliation>
                </author>
            </articleinfo>
            <section xmlns="http://cellml.org/tmp-documentation" id="sec_status">
                <title xmlns="http://cellml.org/tmp-documentation">Model Status</title>
                <para xmlns="http://cellml.org/tmp-documentation">
            This version of this model is known to run in both OpenCell and COR.  The units have been checked and they are consistent.  A generic stimulus protocol has been added to allow the model to simulate trains of action potentials.  Although the model does run, the simulation output is still not quite the same as the original published model.  The original model authors have been contacted and we will continue to curate the CellML model.
          </para>
            </section>
            <sect1 xmlns="http://cellml.org/tmp-documentation" id="sec_structure">
                <title xmlns="http://cellml.org/tmp-documentation">Model Structure</title>
                <para xmlns="http://cellml.org/tmp-documentation">
ABSTRACT: In this paper we introduce and study a model for electrical activity of cardiac membrane which incorporates only an inward and an outward current. This model is useful for three reasons: (1) Its simplicity, comparable to the FitzHugh-Nagumo model, makes it useful in numerical simulations, especially in two or three spatial dimensions where numerical efficiency is so important. (2) It can be understood analytically without recourse to numerical simulations. This allows us to determine rather completely how the parameters in the model affect its behavior which in turn provides insight into the effects of the many parameters in more realistic models. (3) It naturally gives rise to a one-dimensional map which specifies the action potential duration as a function of the previous diastolic interval. For certain parameter values, this map exhibits a new phenomenon--subcritical alternans--that does not occur for the commonly used exponential map.
</para>
                <para xmlns="http://cellml.org/tmp-documentation">
The original paper reference is cited below:
</para>
                <para xmlns="http://cellml.org/tmp-documentation">
          A two-current model for the dynamics of cardiac membrane, Colleen C. Mitchell, David G. Schaeffer, 2003, <emphasis xmlns="http://cellml.org/tmp-documentation">Bulletin of Mathematical Biology</emphasis>, 65, (5), 767-793.  <ulink xmlns="http://cellml.org/tmp-documentation" url="http://www.ncbi.nlm.nih.gov/pubmed/12909250">PubMed ID: 12909250</ulink>
                </para>
                <informalfigure xmlns="http://cellml.org/tmp-documentation" float="0" id="fig_cell_diagram">
                    <mediaobject xmlns="http://cellml.org/tmp-documentation">
                        <imageobject xmlns="http://cellml.org/tmp-documentation">
                            <objectinfo xmlns="http://cellml.org/tmp-documentation">
                                <title xmlns="http://cellml.org/tmp-documentation">cell diagram</title>
                            </objectinfo>
                            <imagedata xmlns="http://cellml.org/tmp-documentation" fileref="mitchell_2003.png"/>
                        </imageobject>
                    </mediaobject>
                    <caption xmlns="http://cellml.org/tmp-documentation">A schematic diagram of the two ionic currents described by the Mitchell-Schaeffer model of a ventricular myocyte.</caption>
                </informalfigure>
            </sect1>
        </article>
    </documentation>
    <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
        <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="rdf:#a6d68ad4-f798-4744-893c-c5570c4b7906">
            <rdf:type xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
                <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="http://www.w3.org/1999/02/22-rdf-syntax-ns#Seq"/>
            </rdf:type>
            <rdf:_1 xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
                <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="rdf:#648f422e-3f39-42a3-a68b-bd2edba72eef"/>
            </rdf:_1>
            <rdf:_2 xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
                <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="rdf:#8bae96c4-4154-4e46-b0e8-517d8933a8fb"/>
            </rdf:_2>
        </rdf:Description>
        <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="rdf:#648f422e-3f39-42a3-a68b-bd2edba72eef">
            <rdf:type xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
                <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="http://www.cellml.org/bqs/1.0#Person"/>
            </rdf:type>
            <N xmlns="http://www.w3.org/2001/vcard-rdf/3.0#">
                <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="rdf:#e7179c22-ff06-4703-b642-635d85b70dad"/>
            </N>
        </rdf:Description>
        <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="rdf:#8bae96c4-4154-4e46-b0e8-517d8933a8fb">
            <rdf:type xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
                <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="http://www.cellml.org/bqs/1.0#Person"/>
            </rdf:type>
            <N xmlns="http://www.w3.org/2001/vcard-rdf/3.0#">
                <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="rdf:#e01f08e9-ed31-4467-b6e8-ae4c3a46a271"/>
            </N>
        </rdf:Description>
        <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="rdf:#e7179c22-ff06-4703-b642-635d85b70dad">
            <Given xmlns="http://www.w3.org/2001/vcard-rdf/3.0#" xml:lang="en" xmlns:xml="http://www.w3.org/XML/1998/namespace">Colleen</Given>
            <Family xmlns="http://www.w3.org/2001/vcard-rdf/3.0#" xml:lang="en" xmlns:xml="http://www.w3.org/XML/1998/namespace">Mitchell</Family>
            <Other xmlns="http://www.w3.org/2001/vcard-rdf/3.0#" xml:lang="en" xmlns:xml="http://www.w3.org/XML/1998/namespace">C</Other>
        </rdf:Description>
        <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="rdf:#e01f08e9-ed31-4467-b6e8-ae4c3a46a271">
            <Given xmlns="http://www.w3.org/2001/vcard-rdf/3.0#" xml:lang="en" xmlns:xml="http://www.w3.org/XML/1998/namespace">David</Given>
            <Family xmlns="http://www.w3.org/2001/vcard-rdf/3.0#" xml:lang="en" xmlns:xml="http://www.w3.org/XML/1998/namespace">Schaeffer</Family>
            <Other xmlns="http://www.w3.org/2001/vcard-rdf/3.0#" xml:lang="en" xmlns:xml="http://www.w3.org/XML/1998/namespace">G</Other>
        </rdf:Description>
        <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="#mitchell_2003">
            <reference xmlns="http://www.cellml.org/bqs/1.0#">
                <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="rdf:#ffe6e056-ca1e-474b-9607-12f660551233"/>
            </reference>
            <reference xmlns="http://www.cellml.org/bqs/1.0#">
                <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:nodeID="n1"/>
            </reference>
            <comment xmlns="http://www.cellml.org/cellml/1.0#">
                <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="rdf:#8037464e-49b9-458a-87c2-6bea12c1f094"/>
            </comment>
        </rdf:Description>
        <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="rdf:#ffe6e056-ca1e-474b-9607-12f660551233">
            <Pubmed_id xmlns="http://www.cellml.org/bqs/1.0#" xml:lang="en" xmlns:xml="http://www.w3.org/XML/1998/namespace">12909250</Pubmed_id>
            <JournalArticle xmlns="http://www.cellml.org/bqs/1.0#">
                <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="rdf:#7f456c83-9f95-49e1-9322-920eef030bae"/>
            </JournalArticle>
        </rdf:Description>
        <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="rdf:#8037464e-49b9-458a-87c2-6bea12c1f094">
            <rdf:value xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xml:lang="en" xmlns:xml="http://www.w3.org/XML/1998/namespace"/>
            <creator xmlns="http://purl.org/dc/elements/1.1/">
                <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="rdf:#00ddefec-7401-4799-b835-fd0aad67a29f"/>
            </creator>
        </rdf:Description>
        <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="rdf:#7f456c83-9f95-49e1-9322-920eef030bae">
            <creator xmlns="http://purl.org/dc/elements/1.1/">
                <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="rdf:#a6d68ad4-f798-4744-893c-c5570c4b7906"/>
            </creator>
            <title xmlns="http://purl.org/dc/elements/1.1/" xml:lang="en" xmlns:xml="http://www.w3.org/XML/1998/namespace">A two-current model for the dynamics of cardiac membrane</title>
            <volume xmlns="http://www.cellml.org/bqs/1.0#" xml:lang="en" xmlns:xml="http://www.w3.org/XML/1998/namespace">65</volume>
            <first_page xmlns="http://www.cellml.org/bqs/1.0#" xml:lang="en" xmlns:xml="http://www.w3.org/XML/1998/namespace">767</first_page>
            <Journal xmlns="http://www.cellml.org/bqs/1.0#">
                <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="rdf:#72c9cd1b-c7b1-466f-a2cd-1daca5321746"/>
            </Journal>
            <issued xmlns="http://purl.org/dc/terms/">
                <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="rdf:#d094409d-3045-446b-9d48-3be8df96c261"/>
            </issued>
            <last_page xmlns="http://www.cellml.org/bqs/1.0#" xml:lang="en" xmlns:xml="http://www.w3.org/XML/1998/namespace">793</last_page>
        </rdf:Description>
        <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="rdf:#00ddefec-7401-4799-b835-fd0aad67a29f">
            <FN xmlns="http://www.w3.org/2001/vcard-rdf/3.0#">
                <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:nodeID="n2"/>
            </FN>
        </rdf:Description>
        <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="rdf:#72c9cd1b-c7b1-466f-a2cd-1daca5321746">
            <title xmlns="http://purl.org/dc/elements/1.1/" xml:lang="en" xmlns:xml="http://www.w3.org/XML/1998/namespace">Bulletin of Mathematical Biology</title>
        </rdf:Description>
        <rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="rdf:#d094409d-3045-446b-9d48-3be8df96c261">
            <W3CDTF xmlns="http://purl.org/dc/terms/" xml:lang="en" xmlns:xml="http://www.w3.org/XML/1998/namespace">2003-09-00 00:00</W3CDTF>
        </rdf:Description>
    </rdf:RDF>
</model>
